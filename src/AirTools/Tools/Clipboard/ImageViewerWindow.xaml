<Window x:Class="AirTools.Tools.Clipboard.ImageViewerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="图片预览"
        Width="1000" Height="720"
        MinWidth="560" MinHeight="420"
        WindowStartupLocation="CenterOwner"
        Background="Transparent"
        FontFamily="Microsoft YaHei UI, Segoe UI"
        WindowStyle="None"
        AllowsTransparency="True"
        KeyDown="Window_KeyDown">

    <Window.Resources>
        <SolidColorBrush x:Key="BgDark" Color="#B01A1D2B"/>
        <SolidColorBrush x:Key="BgCard" Color="#8C2B3040"/>
        <SolidColorBrush x:Key="BgCardHover" Color="#B03D4358"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#CDD6F4"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#A6ADC8"/>
        <SolidColorBrush x:Key="TextDim" Color="#8B90AA"/>
        <SolidColorBrush x:Key="BorderColor" Color="#70FFFFFF"/>
        <SolidColorBrush x:Key="AccentColor" Color="#89B4FA"/>
        <SolidColorBrush x:Key="CanvasBg" Color="#08080C"/>
    </Window.Resources>

    <Border CornerRadius="10" Background="{DynamicResource BgDark}" BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
        <Border.Effect>
            <DropShadowEffect Color="#88000000" BlurRadius="14" ShadowDepth="0" Opacity="0.5"/>
        </Border.Effect>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Background="{DynamicResource BgCard}" Padding="10,8" CornerRadius="10,10,0,0"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <DockPanel LastChildFill="False">
                    <TextBlock x:Name="TxtZoom" Text="100%" VerticalAlignment="Center" Margin="4,0,12,0" FontSize="13" Foreground="{DynamicResource TextPrimary}"/>
                    <Button Content="➖" Width="32" Height="28" Margin="0,0,4,0" Click="BtnZoomOut_Click"
                            Background="{DynamicResource BgCardHover}" Foreground="{DynamicResource TextPrimary}" BorderThickness="0" Cursor="Hand"/>
                    <Button Content="➕" Width="32" Height="28" Margin="0,0,4,0" Click="BtnZoomIn_Click"
                            Background="{DynamicResource BgCardHover}" Foreground="{DynamicResource TextPrimary}" BorderThickness="0" Cursor="Hand"/>
                    <Button Content="100%" Width="56" Height="28" Margin="0,0,4,0" Click="BtnReset_Click"
                            Background="{DynamicResource BgCardHover}" Foreground="{DynamicResource TextPrimary}" BorderThickness="0" Cursor="Hand"/>
                    <Button Content="适应" Width="52" Height="28" Margin="0,0,12,0" Click="BtnFitWindow_Click"
                            Background="{DynamicResource BgCardHover}" Foreground="{DynamicResource TextPrimary}" BorderThickness="0" Cursor="Hand"/>
                    <TextBlock Text="滚轮缩放 · 拖拽平移 · Esc 关闭" VerticalAlignment="Center" Foreground="{DynamicResource TextDim}" FontSize="12"/>
                    <Button Content="✕" DockPanel.Dock="Right" Click="BtnClose_Click" Width="28" Height="28" FontSize="12" Cursor="Hand"
                            Background="Transparent" Foreground="{DynamicResource TextSecondary}" BorderThickness="0" ToolTip="关闭">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="6" Padding="4">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="{DynamicResource BgCardHover}"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </DockPanel>
            </Border>

            <Border Grid.Row="1" x:Name="CanvasHost" Background="{DynamicResource CanvasBg}" ClipToBounds="True" CornerRadius="0,0,10,10"
                    MouseWheel="CanvasHost_MouseWheel" MouseLeftButtonDown="CanvasHost_MouseLeftButtonDown"
                    MouseLeftButtonUp="CanvasHost_MouseLeftButtonUp" MouseMove="CanvasHost_MouseMove" SizeChanged="CanvasHost_SizeChanged">
                <Image x:Name="ImgPreview" Stretch="None" RenderOptions.BitmapScalingMode="HighQuality" SnapsToDevicePixels="True"
                       HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Image.RenderTransform>
                        <MatrixTransform x:Name="ImageTransform"/>
                    </Image.RenderTransform>
                </Image>
            </Border>
        </Grid>
    </Border>
</Window>
